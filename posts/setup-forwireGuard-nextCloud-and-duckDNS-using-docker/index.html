<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Setup For WireGuard, NextCloud, and DuckDNS using Docker (G)" /><meta property="og:locale" content="en" /><meta name="description" content="Basic configuration" /><meta property="og:description" content="Basic configuration" /><link rel="canonical" href="https://gitjmc.github.io/posts/setup-forwireGuard-nextCloud-and-duckDNS-using-docker/" /><meta property="og:url" content="https://gitjmc.github.io/posts/setup-forwireGuard-nextCloud-and-duckDNS-using-docker/" /><meta property="og:site_name" content="JMC-memo" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-02-15T08:35:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Setup For WireGuard, NextCloud, and DuckDNS using Docker (G)" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-03-09T17:19:19-04:00","datePublished":"2025-02-15T08:35:00-05:00","description":"Basic configuration","headline":"Setup For WireGuard, NextCloud, and DuckDNS using Docker (G)","mainEntityOfPage":{"@type":"WebPage","@id":"https://gitjmc.github.io/posts/setup-forwireGuard-nextCloud-and-duckDNS-using-docker/"},"url":"https://gitjmc.github.io/posts/setup-forwireGuard-nextCloud-and-duckDNS-using-docker/"}</script><title>Setup For WireGuard, NextCloud, and DuckDNS using Docker (G) | JMC-memo</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="JMC-memo"><meta name="application-name" content="JMC-memo"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://gitjmc.github.io/assets/img/favicons/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">JMC-memo</a></div><div class="site-subtitle font-italic">À la demande de sisi</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/gitjmc" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Setup For WireGuard, NextCloud, and DuckDNS using Docker (G)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Setup For WireGuard, NextCloud, and DuckDNS using Docker (G)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/username">Jerbi Mohamed Chamseddine</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1739626500" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2025-02-15 </em> </span> <span> Updated <em class="timeago" data-ts="1741555159" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2025-03-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3284 words"> <em>18 min</em> read</span></div></div></div><div class="post-content"><h1 id="basic-configuration">Basic configuration</h1><p>It seems like you meant “DuckDNS” instead of “dukdns”—I’ll assume that and proceed with a setup for WireGuard, NextCloud, and DuckDNS using Docker. This combination gives you a secure VPN (WireGuard), self-hosted cloud storage (NextCloud), and dynamic DNS (DuckDNS) to keep your domain updated with your IP. Here’s a streamlined, practical approach using Docker Compose for simplicity and maintainability, assuming you’re running this on a single machine (like a home server or VPS).</p><h3 id="docker-compose-setup"><span class="mr-2">Docker Compose Setup</span><a href="#docker-compose-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>First, make sure you have Docker and Docker Compose installed. Then, create a directory for this project (e.g., <code class="language-plaintext highlighter-rouge">~/cloud-vpn</code>), and inside it, create a <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> file with the following content:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3'</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="na">duckdns</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">linuxserver/duckdns</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">duckdns</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">TOKEN=your-duckdns-token</span> <span class="c1"># Replace with your DuckDNS token</span>
      <span class="pi">-</span> <span class="s">SUBDOMAINS=your-subdomain</span> <span class="c1"># Replace with your DuckDNS subdomain (e.g., mycloud)</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./duckdns:/config</span> <span class="c1"># Stores logs, not critical but useful</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>

  <span class="na">wireguard</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">linuxserver/wireguard</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">wireguard</span>
    <span class="na">cap_add</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">NET_ADMIN</span>
      <span class="pi">-</span> <span class="s">SYS_MODULE</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">PUID=1000</span> <span class="c1"># Your user ID, adjust if needed</span>
      <span class="pi">-</span> <span class="s">PGID=1000</span> <span class="c1"># Your group ID, adjust if needed</span>
      <span class="pi">-</span> <span class="s">TZ=America/New_York</span> <span class="c1"># Adjust to your timezone</span>
      <span class="pi">-</span> <span class="s">SERVERURL=your-subdomain.duckdns.org</span> <span class="c1"># Your DuckDNS domain</span>
      <span class="pi">-</span> <span class="s">SERVERPORT=51820</span>
      <span class="pi">-</span> <span class="s">PEERS=2</span> <span class="c1"># Number of clients (adjust as needed)</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./wireguard:/config</span> <span class="c1"># Stores WireGuard config and keys</span>
      <span class="pi">-</span> <span class="s">/lib/modules:/lib/modules:ro</span> <span class="c1"># For kernel module loading</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">51820:51820/udp</span> <span class="c1"># WireGuard port</span>
    <span class="na">sysctls</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">net.ipv4.conf.all.src_valid_mark=1</span> <span class="c1"># Needed for WireGuard</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>

  <span class="na">db</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">mariadb:10.5</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">nextcloud-db</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">MYSQL_ROOT_PASSWORD=your-root-password</span> <span class="c1"># Replace with a secure password</span>
      <span class="pi">-</span> <span class="s">MYSQL_DATABASE=nextcloud</span>
      <span class="pi">-</span> <span class="s">MYSQL_USER=nextcloud</span>
      <span class="pi">-</span> <span class="s">MYSQL_PASSWORD=your-db-password</span> <span class="c1"># Replace with a secure password</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./db:/var/lib/mysql</span> <span class="c1"># Persists database data</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>

  <span class="na">nextcloud</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">nextcloud:latest</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">nextcloud</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">db</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">MYSQL_HOST=db</span>
      <span class="pi">-</span> <span class="s">MYSQL_DATABASE=nextcloud</span>
      <span class="pi">-</span> <span class="s">MYSQL_USER=nextcloud</span>
      <span class="pi">-</span> <span class="s">MYSQL_PASSWORD=your-db-password</span> <span class="c1"># Match the db service password</span>
      <span class="pi">-</span> <span class="s">NEXTCLOUD_ADMIN_USER=admin</span> <span class="c1"># Initial admin username</span>
      <span class="pi">-</span> <span class="s">NEXTCLOUD_ADMIN_PASSWORD=your-admin-password</span> <span class="c1"># Replace with a secure password</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./nextcloud:/var/www/html</span> <span class="c1"># Persists NextCloud data</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">8080:80</span> <span class="c1"># Maps NextCloud to port 8080 on host</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
</pre></table></code></div></div><h3 id="steps-to-install-and-configure"><span class="mr-2">Steps to Install and Configure</span><a href="#steps-to-install-and-configure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ol><li><strong>Prep Work</strong><ul><li>Sign up at <a href="https://www.duckdns.org">DuckDNS</a>, get your token, and pick a subdomain (e.g., <code class="language-plaintext highlighter-rouge">mycloud</code> → <code class="language-plaintext highlighter-rouge">mycloud.duckdns.org</code>).<li>Replace placeholders in the <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> file:<ul><li><code class="language-plaintext highlighter-rouge">your-duckdns-token</code> and <code class="language-plaintext highlighter-rouge">your-subdomain</code> under <code class="language-plaintext highlighter-rouge">duckdns</code>.<li><code class="language-plaintext highlighter-rouge">your-subdomain.duckdns.org</code> under <code class="language-plaintext highlighter-rouge">wireguard</code>.<li>Passwords under <code class="language-plaintext highlighter-rouge">db</code> and <code class="language-plaintext highlighter-rouge">nextcloud</code> (use strong, unique ones).</ul><li>Create the directory structure: <code class="language-plaintext highlighter-rouge">mkdir ~/cloud-vpn &amp;&amp; cd ~/cloud-vpn</code>.</ul><li><strong>Start the Services</strong><ul><li>Run <code class="language-plaintext highlighter-rouge">docker-compose up -d</code> in the directory with your <code class="language-plaintext highlighter-rouge">docker-compose.yml</code>. This pulls the images and starts the containers.<li>Check logs to ensure everything’s running: <code class="language-plaintext highlighter-rouge">docker-compose logs</code>.</ul><li><strong>Configure WireGuard</strong><ul><li>After starting, WireGuard generates client configs in <code class="language-plaintext highlighter-rouge">./wireguard/qr_codes/</code> or <code class="language-plaintext highlighter-rouge">./wireguard/config/peerX/</code>. Copy these to your devices (e.g., via QR code for mobile or <code class="language-plaintext highlighter-rouge">.conf</code> file for desktop).<li>Install the WireGuard client on your device (see <a href="https://www.wireguard.com/install/">wireguard.com/install</a>), import the config, and connect.</ul><li><strong>Set Up NextCloud</strong><ul><li>Open your browser to <code class="language-plaintext highlighter-rouge">http://localhost:8080</code> (or your server’s IP:8080 if remote). The first time, NextCloud finishes setup using the admin credentials from the compose file.<li>Once set up, configure NextCloud to trust your DuckDNS domain under Settings &gt; Administration &gt; General (e.g., <code class="language-plaintext highlighter-rouge">mycloud.duckdns.org</code>).</ul><li><strong>Secure Access</strong><ul><li>By default, NextCloud is on port 8080 and accessible locally. To restrict it to WireGuard:<ul><li>Edit the <code class="language-plaintext highlighter-rouge">ports</code> line under <code class="language-plaintext highlighter-rouge">nextcloud</code> to remove <code class="language-plaintext highlighter-rouge">- 8080:80</code> (making it internal-only).<li>Access it via the VPN at <code class="language-plaintext highlighter-rouge">http://nextcloud:80</code> (Docker’s internal networking) or set up a reverse proxy if needed.</ul><li>Alternatively, use your firewall (e.g., <code class="language-plaintext highlighter-rouge">ufw</code> or <code class="language-plaintext highlighter-rouge">iptables</code>) to allow only WireGuard subnet traffic (e.g., <code class="language-plaintext highlighter-rouge">10.13.13.0/24</code>, check your WireGuard config).</ul><li><strong>Test It</strong><ul><li>Connect to WireGuard on a client device.<li>Visit <code class="language-plaintext highlighter-rouge">http://your-subdomain.duckdns.org:8080</code> (or internal URL if ports are removed) to access NextCloud securely.<li>DuckDNS keeps your domain updated, so it works even if your public IP changes.</ul></ol><h3 id="why-this-is-the-best-way"><span class="mr-2">Why This Is the Best Way</span><a href="#why-this-is-the-best-way" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><strong>Docker Compose</strong>: Manages all services in one file, making it easy to start, stop, or tweak settings.<li><strong>Security</strong>: WireGuard encrypts traffic, and restricting NextCloud to VPN access adds a layer of protection.<li><strong>Simplicity</strong>: DuckDNS handles dynamic IPs without complex DNS setups, and the chosen images (LinuxServer and official NextCloud) are reliable and well-documented.</ul><h3 id="tips-and-tweaks"><span class="mr-2">Tips and Tweaks</span><a href="#tips-and-tweaks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><strong>HTTPS</strong>: For production, add a reverse proxy like Nginx or Traefik with Let’s Encrypt for SSL on NextCloud (port 443).<li><strong>Storage</strong>: Mount external drives to <code class="language-plaintext highlighter-rouge">./nextcloud</code> for more space.<li><strong>Backup</strong>: Regularly back up <code class="language-plaintext highlighter-rouge">./db</code> and <code class="language-plaintext highlighter-rouge">./nextcloud</code> directories.<li><strong>Troubleshooting</strong>: Use <code class="language-plaintext highlighter-rouge">docker-compose logs &lt;service&gt;</code> to debug if something fails.</ul><h1 id="lets-enhance-security">Let’s enhance security</h1><h2 id="adding-https-for-secure-browsing-and-adjusting-the-firewall"><span class="mr-2">Adding HTTPS for secure browsing and adjusting the firewall</span><a href="#adding-https-for-secure-browsing-and-adjusting-the-firewall" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let’s enhance your WireGuard, NextCloud, and DuckDNS setup by adding HTTPS for secure browsing and adjusting the firewall to restrict NextCloud access to WireGuard VPN clients only. I’ll assume you’re using the Docker Compose setup from my previous response and build on it. We’ll use Nginx Proxy Manager for HTTPS (simpler than raw Nginx or Traefik for beginners) and configure <code class="language-plaintext highlighter-rouge">iptables</code> for the firewall.</p><hr /><h3 id="step-1-setting-up-https-with-nginx-proxy-manager"><span class="mr-2">Step 1: Setting Up HTTPS with Nginx Proxy Manager</span><a href="#step-1-setting-up-https-with-nginx-proxy-manager" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><h4 id="why-nginx-proxy-manager"><span class="mr-2">Why Nginx Proxy Manager?</span><a href="#why-nginx-proxy-manager" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>It’s a Docker-friendly tool with a web UI to manage reverse proxies and SSL certificates via Let’s Encrypt, making HTTPS setup straightforward.</p><h4 id="updated-docker-compose"><span class="mr-2">Updated Docker Compose</span><a href="#updated-docker-compose" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Add Nginx Proxy Manager to your <code class="language-plaintext highlighter-rouge">docker-compose.yml</code>. Here’s the full updated file (replace your existing one, keeping your custom values like tokens and passwords):</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3'</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="na">duckdns</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">linuxserver/duckdns</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">duckdns</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">TOKEN=your-duckdns-token</span>
      <span class="pi">-</span> <span class="s">SUBDOMAINS=your-subdomain</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./duckdns:/config</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>

  <span class="na">wireguard</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">linuxserver/wireguard</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">wireguard</span>
    <span class="na">cap_add</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">NET_ADMIN</span>
      <span class="pi">-</span> <span class="s">SYS_MODULE</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">PUID=1000</span>
      <span class="pi">-</span> <span class="s">PGID=1000</span>
      <span class="pi">-</span> <span class="s">TZ=America/New_York</span>
      <span class="pi">-</span> <span class="s">SERVERURL=your-subdomain.duckdns.org</span>
      <span class="pi">-</span> <span class="s">SERVERPORT=51820</span>
      <span class="pi">-</span> <span class="s">PEERS=2</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./wireguard:/config</span>
      <span class="pi">-</span> <span class="s">/lib/modules:/lib/modules:ro</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">51820:51820/udp</span>
    <span class="na">sysctls</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">net.ipv4.conf.all.src_valid_mark=1</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>

  <span class="na">db</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">mariadb:10.5</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">nextcloud-db</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">MYSQL_ROOT_PASSWORD=your-root-password</span>
      <span class="pi">-</span> <span class="s">MYSQL_DATABASE=nextcloud</span>
      <span class="pi">-</span> <span class="s">MYSQL_USER=nextcloud</span>
      <span class="pi">-</span> <span class="s">MYSQL_PASSWORD=your-db-password</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./db:/var/lib/mysql</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>

  <span class="na">nextcloud</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">nextcloud:latest</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">nextcloud</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">db</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">MYSQL_HOST=db</span>
      <span class="pi">-</span> <span class="s">MYSQL_DATABASE=nextcloud</span>
      <span class="pi">-</span> <span class="s">MYSQL_USER=nextcloud</span>
      <span class="pi">-</span> <span class="s">MYSQL_PASSWORD=your-db-password</span>
      <span class="pi">-</span> <span class="s">NEXTCLOUD_ADMIN_USER=admin</span>
      <span class="pi">-</span> <span class="s">NEXTCLOUD_ADMIN_PASSWORD=your-admin-password</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./nextcloud:/var/www/html</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="c1"># Note: No ports exposed here; Nginx Proxy Manager will handle access</span>

  <span class="na">nginx-proxy-manager</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">jc21/nginx-proxy-manager:latest</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">nginx-proxy-manager</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">80:80</span>    <span class="c1"># HTTP</span>
      <span class="pi">-</span> <span class="s">443:443</span>  <span class="c1"># HTTPS</span>
      <span class="pi">-</span> <span class="s">81:81</span>    <span class="c1"># Web UI</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">DB_MYSQL_HOST=db</span>
      <span class="pi">-</span> <span class="s">DB_MYSQL_PORT=3306</span>
      <span class="pi">-</span> <span class="s">DB_MYSQL_USER=nginxpm</span>
      <span class="pi">-</span> <span class="s">DB_MYSQL_PASSWORD=nginxpm-password</span> <span class="c1"># Replace with a secure password</span>
      <span class="pi">-</span> <span class="s">DB_MYSQL_DATABASE=nginxpm</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./nginx-proxy-manager/data:/data</span>
      <span class="pi">-</span> <span class="s">./nginx-proxy-manager/letsencrypt:/etc/letsencrypt</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">db</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
</pre></table></code></div></div><h4 id="steps-to-set-up-https"><span class="mr-2">Steps to Set Up HTTPS</span><a href="#steps-to-set-up-https" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ol><li><strong>Update and Restart</strong><ul><li>Save the updated <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> in your <code class="language-plaintext highlighter-rouge">~/cloud-vpn</code> directory.<li>Run <code class="language-plaintext highlighter-rouge">docker-compose up -d</code> to recreate containers with the new service.</ul><li><strong>Initial Nginx Proxy Manager Setup</strong><ul><li>Open <code class="language-plaintext highlighter-rouge">http://your-server-ip:81</code> in your browser (replace <code class="language-plaintext highlighter-rouge">your-server-ip</code> with your machine’s IP, e.g., <code class="language-plaintext highlighter-rouge">192.168.1.100</code> or <code class="language-plaintext highlighter-rouge">localhost</code> if local).<li>Log in with default credentials: <code class="language-plaintext highlighter-rouge">admin@example.com</code> / <code class="language-plaintext highlighter-rouge">changeme</code>.<li>Change the email and password immediately in the UI.</ul><li><strong>Add a Proxy Host</strong><ul><li>In the Nginx Proxy Manager UI, go to “Hosts” &gt; “Proxy Hosts” &gt; “Add Proxy Host”.<li><strong>Details</strong>:<ul><li>Domain Name: <code class="language-plaintext highlighter-rouge">your-subdomain.duckdns.org</code><li>Scheme: <code class="language-plaintext highlighter-rouge">http</code><li>Forward Hostname/IP: <code class="language-plaintext highlighter-rouge">nextcloud</code> (Docker service name)<li>Forward Port: <code class="language-plaintext highlighter-rouge">80</code></ul><li>Enable “Block Common Exploits” and “Websockets Support” for safety and compatibility.<li>Save this configuration.</ul><li><strong>Set Up SSL</strong><ul><li>Edit the proxy host you just created.<li>Go to the “SSL” tab, select “Request a new certificate”.<li>Check “Force SSL” and “HTTP/2 Support”.<li>Agree to Let’s Encrypt terms and save. It’ll fetch a certificate for <code class="language-plaintext highlighter-rouge">your-subdomain.duckdns.org</code>.<li>Wait a minute; if it fails, ensure port 80 is open to the internet (temporary for cert issuance).</ul><li><strong>Test HTTPS</strong><ul><li>Visit <code class="language-plaintext highlighter-rouge">https://your-subdomain.duckdns.org</code>. You should see NextCloud over HTTPS.<li>Update NextCloud’s trusted domains in <code class="language-plaintext highlighter-rouge">./nextcloud/config/config.php</code>:<div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="s1">'trusted_domains'</span> <span class="o">=&gt;</span> 
  <span class="k">array</span> <span class="p">(</span>
    <span class="mi">0</span> <span class="o">=&gt;</span> <span class="s1">'localhost'</span><span class="p">,</span>
    <span class="mi">1</span> <span class="o">=&gt;</span> <span class="s1">'your-subdomain.duckdns.org'</span><span class="p">,</span>
  <span class="p">),</span>
</pre></table></code></div></div></ul></ol><hr /><h3 id="step-2-adjusting-the-firewall-with-iptables"><span class="mr-2">Step 2: Adjusting the Firewall with iptables</span><a href="#step-2-adjusting-the-firewall-with-iptables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><h4 id="goal"><span class="mr-2">Goal</span><a href="#goal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Restrict NextCloud access (via Nginx Proxy Manager on ports 80 and 443) to only WireGuard VPN clients, using the WireGuard subnet (e.g., <code class="language-plaintext highlighter-rouge">10.13.13.0/24</code> from the default linuxserver/wireguard config).</p><h4 id="firewall-setup"><span class="mr-2">Firewall Setup</span><a href="#firewall-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ol><li><strong>Check WireGuard Subnet</strong><ul><li>Look at <code class="language-plaintext highlighter-rouge">./wireguard/config/wg0.conf</code> or client configs (e.g., <code class="language-plaintext highlighter-rouge">AllowedIPs = 10.13.13.0/24</code>). The default is often <code class="language-plaintext highlighter-rouge">10.13.13.0/24</code>; adjust commands below if yours differs.</ul><li><strong>Install iptables (if needed)</strong><ul><li>On Ubuntu/Debian: <code class="language-plaintext highlighter-rouge">sudo apt update &amp;&amp; sudo apt install iptables</code><li>On Fedora: <code class="language-plaintext highlighter-rouge">sudo dnf install iptables</code></ul><li><strong>Flush Existing Rules (Optional)</strong><ul><li>Backup current rules: <code class="language-plaintext highlighter-rouge">sudo iptables-save &gt; iptables-backup.txt</code><li>Flush: <code class="language-plaintext highlighter-rouge">sudo iptables -F</code> (careful, this clears all rules; skip if you have other critical rules).</ul><li><strong>Add Firewall Rules</strong><ul><li>Allow WireGuard traffic (port 51820):<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> udp <span class="nt">--dport</span> 51820 <span class="nt">-j</span> ACCEPT
</pre></table></code></div></div><li>Allow HTTP/HTTPS only from WireGuard subnet:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>iptables <span class="nt">-A</span> INPUT <span class="nt">-s</span> 10.13.13.0/24 <span class="nt">-p</span> tcp <span class="nt">-m</span> multiport <span class="nt">--dports</span> 80,443 <span class="nt">-j</span> ACCEPT
</pre></table></code></div></div><li>Drop all other HTTP/HTTPS traffic:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">-m</span> multiport <span class="nt">--dports</span> 80,443 <span class="nt">-j</span> DROP
</pre></table></code></div></div><li>Allow loopback (local access):<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>iptables <span class="nt">-A</span> INPUT <span class="nt">-i</span> lo <span class="nt">-j</span> ACCEPT
</pre></table></code></div></div><li>Allow established/related connections (for general networking):<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>iptables <span class="nt">-A</span> INPUT <span class="nt">-m</span> conntrack <span class="nt">--ctstate</span> ESTABLISHED,RELATED <span class="nt">-j</span> ACCEPT
</pre></table></code></div></div></ul><li><strong>Save Rules</strong><ul><li>On Ubuntu/Debian: <code class="language-plaintext highlighter-rouge">sudo iptables-save &gt; /etc/iptables/rules.v4</code><li>On Fedora: <code class="language-plaintext highlighter-rouge">sudo iptables-save &gt; /etc/sysconfig/iptables</code><li>Ensure persistence: Install <code class="language-plaintext highlighter-rouge">iptables-persistent</code> (Debian/Ubuntu) or configure a systemd service if needed.</ul><li><strong>Test Firewall</strong><ul><li>Disconnect from WireGuard and try <code class="language-plaintext highlighter-rouge">https://your-subdomain.duckdns.org</code>—it should fail.<li>Connect to WireGuard and try again—it should work.</ul></ol><h4 id="alternative-using-ufw"><span class="mr-2">Alternative: Using ufw</span><a href="#alternative-using-ufw" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>If you prefer <code class="language-plaintext highlighter-rouge">ufw</code> (simpler firewall frontend):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>ufw allow 51820/udp
<span class="nb">sudo </span>ufw allow from 10.13.13.0/24 to any port 80
<span class="nb">sudo </span>ufw allow from 10.13.13.0/24 to any port 443
<span class="nb">sudo </span>ufw deny 80
<span class="nb">sudo </span>ufw deny 443
<span class="nb">sudo </span>ufw <span class="nb">enable</span>
</pre></table></code></div></div><hr /><h3 id="final-notes"><span class="mr-2">Final Notes</span><a href="#final-notes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><strong>HTTPS</strong>: Nginx Proxy Manager handles SSL termination, so NextCloud stays on HTTP internally, which is fine. Certificates auto-renew every 90 days.<li><strong>Firewall</strong>: These rules assume a basic setup. If you’re behind a router, forward ports 80, 443, and 51820/udp to your server, and tweak rules if other services need access.<li><strong>Troubleshooting</strong>:<ul><li>SSL fails? Check port 80 is reachable during cert issuance (<code class="language-plaintext highlighter-rouge">docker logs nginx-proxy-manager</code>).<li>Firewall blocks too much? Review rules with <code class="language-plaintext highlighter-rouge">sudo iptables -L -v</code>.</ul></ul><p>You’re now running NextCloud over HTTPS, accessible only via WireGuard! Let me know if you hit any issues or want further refinements.</p><h1 id="tempo-jmcjmcjmc">Tempo jmcjmcjmc</h1><h3 id="key-points"><span class="mr-2">Key Points</span><a href="#key-points" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>Install WireGuard, NextCloud, and DuckDNS using Docker for a secure, self-hosted cloud with dynamic DNS.<li>Use official or trusted Docker images: linuxserver/duckdns, linuxserver/wireguard, and nextcloud/nextcloud.<li>Configure firewall to restrict NextCloud access to WireGuard VPN clients for enhanced security.<li><strong>Surprising detail</strong>: DuckDNS is a service, not software, so you use a Docker image to update your IP dynamically.</ul><hr /><h3 id="getting-started-with-docker-installations"><span class="mr-2">Getting Started with Docker Installations</span><a href="#getting-started-with-docker-installations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><h4 id="overview"><span class="mr-2">Overview</span><a href="#overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>This guide helps you set up WireGuard (a secure VPN), NextCloud (a self-hosted cloud storage), and DuckDNS (dynamic DNS) using Docker. These services work together to provide a secure way to access your cloud storage remotely, with DuckDNS ensuring your domain name always points to your changing IP address, and WireGuard securing the connection.</p><h4 id="step-by-step-installation"><span class="mr-2">Step-by-Step Installation</span><a href="#step-by-step-installation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ol><li><strong>Set Up DuckDNS</strong><ul><li>Sign up at <a href="https://www.duckdns.org">DuckDNS</a> to get a token and subdomain.<li>Pull the Docker image: <code class="language-plaintext highlighter-rouge">docker pull linuxserver/duckdns</code>.<li>Run the container with your token and subdomain:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker run <span class="nt">-d</span> <span class="nt">--name</span> duckdns <span class="nt">-e</span> <span class="nv">TOKEN</span><span class="o">=</span>your_token <span class="nt">-e</span> <span class="nv">SUBDOMAINS</span><span class="o">=</span>your_subdomain <span class="nt">-v</span> /path/to/config:/config <span class="nt">--restart</span> unless-stopped linuxserver/duckdns
</pre></table></code></div></div><li>This keeps your domain updated with your current IP address.</ul><li><strong>Set Up WireGuard</strong><ul><li>Pull the Docker image: <code class="language-plaintext highlighter-rouge">docker pull linuxserver/wireguard</code>.<li>Run the container, ensuring network admin capabilities:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker run <span class="nt">-d</span> <span class="nt">--name</span> wireguard <span class="nt">--cap-add</span> NET_ADMIN <span class="nt">--cap-add</span> SYS_MODULE <span class="nt">-v</span> /path/to/wireguard/config:/etc/wireguard <span class="nt">-v</span> /lib/modules:/lib/modules <span class="nt">-p</span> 51820:51820/UDP <span class="nt">--restart</span> unless-stopped linuxserver/wireguard
</pre></table></code></div></div><li>Configure the server by editing <code class="language-plaintext highlighter-rouge">/etc/wireguard/wg0.conf</code> inside the container to set up VPN settings and add clients.</ul><li><strong>Set Up NextCloud</strong><ul><li>First, set up a MariaDB database:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker run <span class="nt">-d</span> <span class="nt">--name</span> mariadb <span class="nt">-e</span> <span class="nv">MYSQL_ROOT_PASSWORD</span><span class="o">=</span>your_password <span class="nt">-e</span> <span class="nv">MYSQL_DATABASE</span><span class="o">=</span>nextcloud <span class="nt">-e</span> <span class="nv">MYSQL_USER</span><span class="o">=</span>nextcloud <span class="nt">-e</span> <span class="nv">MYSQL_PASSWORD</span><span class="o">=</span>nextcloud_password <span class="nt">-v</span> /path/to/mariadb/data:/var/lib/mysql <span class="nt">--restart</span> unless-stopped mariadb:10.5
</pre></table></code></div></div><li>Pull the NextCloud image: <code class="language-plaintext highlighter-rouge">docker pull nextcloud/nextcloud</code>.<li>Run NextCloud, linking to the database:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker run <span class="nt">-d</span> <span class="nt">--name</span> nextcloud <span class="nt">--link</span> mariadb:mysql <span class="nt">-e</span> <span class="nv">MYSQL_HOST</span><span class="o">=</span>mysql <span class="nt">-e</span> <span class="nv">MYSQL_DATABASE</span><span class="o">=</span>nextcloud <span class="nt">-e</span> <span class="nv">MYSQL_USER</span><span class="o">=</span>nextcloud <span class="nt">-e</span> <span class="nv">MYSQL_PASSWORD</span><span class="o">=</span>nextcloud_password <span class="nt">-v</span> /path/to/nextcloud/data:/var/lib/nextcloud <span class="nt">-v</span> /path/to/nextcloud/config:/etc/nextcloud <span class="nt">-p</span> 80:80 <span class="nt">-p</span> 443:443 <span class="nt">--restart</span> unless-stopped nextcloud/nextcloud
</pre></table></code></div></div><li>Access NextCloud via your domain name, secured by the VPN.</ul><li><strong>Configure Host Firewall</strong><ul><li>Ensure only WireGuard VPN clients can access NextCloud by restricting ports 80 and 443. Assuming WireGuard subnet is <code class="language-plaintext highlighter-rouge">10.0.0.0/24</code>, use:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>iptables <span class="nt">-A</span> INPUT <span class="nt">-s</span> 10.0.0.0/24 <span class="nt">-p</span> tcp <span class="nt">--dport</span> 80 <span class="nt">-j</span> ACCEPT
iptables <span class="nt">-A</span> INPUT <span class="nt">-s</span> 10.0.0.0/24 <span class="nt">-p</span> tcp <span class="nt">--dport</span> 443 <span class="nt">-j</span> ACCEPT
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 80 <span class="nt">-j</span> DROP
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 443 <span class="nt">-j</span> DROP
</pre></table></code></div></div><li>Adjust the subnet based on your WireGuard setup.</ul><li><strong>Configure WireGuard Clients</strong><ul><li>Install WireGuard on client devices (see <a href="https://www.wireguard.com/install">WireGuard</a> for instructions).<li>Set up client configurations with server details and connect to the VPN.<li>Access NextCloud via the DuckDNS domain name; traffic will be secure through the VPN.</ul></ol><hr /><hr /><h3 id="survey-note-detailed-installation-guide-for-wireguard-nextcloud-and-duckdns-on-docker"><span class="mr-2">Survey Note: Detailed Installation Guide for WireGuard, NextCloud, and DuckDNS on Docker</span><a href="#survey-note-detailed-installation-guide-for-wireguard-nextcloud-and-duckdns-on-docker" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>This comprehensive guide outlines the installation and configuration of WireGuard, NextCloud, and DuckDNS using Docker, ensuring a secure, self-hosted cloud storage solution with dynamic DNS capabilities. Each step is detailed to cater to users with varying levels of technical expertise, leveraging official and trusted Docker images for reliability.</p><h4 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>The integration of WireGuard, NextCloud, and DuckDNS via Docker provides a robust setup for remote access to personal cloud storage, secured by a VPN and managed through dynamic DNS. WireGuard offers a fast, secure VPN tunnel, NextCloud serves as a self-hosted cloud storage alternative to services like Dropbox, and DuckDNS ensures domain name resolution despite changing IP addresses. This setup is particularly useful for home servers or VPS environments where IP addresses may not be static.</p><h4 id="background-and-rationale"><span class="mr-2">Background and Rationale</span><a href="#background-and-rationale" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>WireGuard, introduced as a modern VPN protocol, utilizes state-of-the-art cryptography and is designed for simplicity and performance, often outperforming OpenVPN and IPsec. NextCloud, an open-source platform, offers features akin to Google Drive or Microsoft 365, with the advantage of hosting on your own server for enhanced privacy and control. DuckDNS, a free dynamic DNS service, is essential for maintaining domain accessibility with dynamic IPs, commonly encountered in residential internet connections.</p><p>The decision to use Docker for these installations stems from its containerization benefits, including ease of deployment, isolation, and portability. Docker images from trusted sources like LinuxServer.io and the official NextCloud repository ensure security and regular updates.</p><h4 id="detailed-installation-steps"><span class="mr-2">Detailed Installation Steps</span><a href="#detailed-installation-steps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><h5 id="1-duckdns-setup"><span class="mr-2">1. DuckDNS Setup</span><a href="#1-duckdns-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>DuckDNS is not software to install but a service requiring a client to update your IP. The linuxserver/duckdns Docker image is recommended for this purpose, as it is well-maintained and documented.</p><ul><li><strong>Sign Up and Obtain Credentials</strong>: Visit <a href="https://www.duckdns.org">DuckDNS</a> to create an account, obtain a token, and choose a subdomain (e.g., <code class="language-plaintext highlighter-rouge">yourname.duckdns.org</code>).<li><strong>Pull the Docker Image</strong>: Execute <code class="language-plaintext highlighter-rouge">docker pull linuxserver/duckdns</code> to download the image.<li><strong>Run the Container</strong>: Use the following command, replacing <code class="language-plaintext highlighter-rouge">your_token</code> and <code class="language-plaintext highlighter-rouge">your_subdomain</code> with your credentials:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker run <span class="nt">-d</span> <span class="nt">--name</span> duckdns <span class="nt">-e</span> <span class="nv">TOKEN</span><span class="o">=</span>your_token <span class="nt">-e</span> <span class="nv">SUBDOMAINS</span><span class="o">=</span>your_subdomain <span class="nt">-v</span> /path/to/config:/config <span class="nt">--restart</span> unless-stopped linuxserver/duckdns
</pre></table></code></div></div><ul><li>The <code class="language-plaintext highlighter-rouge">-v</code> flag mounts a configuration directory for persistence, and <code class="language-plaintext highlighter-rouge">--restart unless-stopped</code> ensures the container restarts on system reboot.</ul><li><strong>Verification</strong>: Check logs with <code class="language-plaintext highlighter-rouge">docker logs duckdns</code> to ensure updates are occurring, typically every 5 minutes by default.</ul><p>Documentation for this setup is available at <a href="https://docs.linuxserver.io/images/docker-duckdns/">linuxserver/duckdns documentation</a>.</p><h5 id="2-wireguard-setup"><span class="mr-2">2. WireGuard Setup</span><a href="#2-wireguard-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>WireGuard requires the kernel module to be loaded, which can be managed within Docker using the linuxserver/wireguard image, known for its reliability and support for multiple architectures.</p><ul><li><strong>Pull the Docker Image</strong>: Run <code class="language-plaintext highlighter-rouge">docker pull linuxserver/wireguard</code> to fetch the image.<li><strong>Run the Container</strong>: Launch with necessary capabilities and port mappings:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker run <span class="nt">-d</span> <span class="nt">--name</span> wireguard <span class="nt">--cap-add</span> NET_ADMIN <span class="nt">--cap-add</span> SYS_MODULE <span class="nt">-v</span> /path/to/wireguard/config:/etc/wireguard <span class="nt">-v</span> /lib/modules:/lib/modules <span class="nt">-p</span> 51820:51820/UDP <span class="nt">--restart</span> unless-stopped linuxserver/wireguard
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">--cap-add NET_ADMIN</code> and <code class="language-plaintext highlighter-rouge">--cap-add SYS_MODULE</code> are required for network administration and kernel module loading, respectively.<li><code class="language-plaintext highlighter-rouge">-p 51820:51820/UDP</code> maps the default WireGuard port, adjustable based on your needs.</ul><li><strong>Configuration</strong>: Access the container’s <code class="language-plaintext highlighter-rouge">/etc/wireguard/wg0.conf</code> to set up the server. Generate keys using <code class="language-plaintext highlighter-rouge">wg genkey</code> and <code class="language-plaintext highlighter-rouge">wg pubkey</code> for server and clients, defining peers and subnets (e.g., <code class="language-plaintext highlighter-rouge">10.0.0.0/24</code> for VPN IPs).<li><strong>Client Setup</strong>: Distribute client configurations, ensuring they connect to the server’s public IP on port 51820.</ul><p>Refer to <a href="https://docs.linuxserver.io/images/docker-wireguard/">linuxserver/wireguard documentation</a> for detailed configuration options.</p><h5 id="3-nextcloud-setup"><span class="mr-2">3. NextCloud Setup</span><a href="#3-nextcloud-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>NextCloud requires a database backend, commonly MariaDB, and can be deployed using the official nextcloud/nextcloud image for ease of use.</p><ul><li><strong>Database Setup (MariaDB)</strong>:<ul><li>Run the MariaDB container:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker run <span class="nt">-d</span> <span class="nt">--name</span> mariadb <span class="nt">-e</span> <span class="nv">MYSQL_ROOT_PASSWORD</span><span class="o">=</span>your_password <span class="nt">-e</span> <span class="nv">MYSQL_DATABASE</span><span class="o">=</span>nextcloud <span class="nt">-e</span> <span class="nv">MYSQL_USER</span><span class="o">=</span>nextcloud <span class="nt">-e</span> <span class="nv">MYSQL_PASSWORD</span><span class="o">=</span>nextcloud_password <span class="nt">-v</span> /path/to/mariadb/data:/var/lib/mysql <span class="nt">--restart</span> unless-stopped mariadb:10.5
</pre></table></code></div></div><li>Replace passwords and paths as needed, ensuring data persistence with the volume mount.</ul><li><strong>Pull NextCloud Image</strong>: Execute <code class="language-plaintext highlighter-rouge">docker pull nextcloud/nextcloud</code> to get the latest image.<li><strong>Run NextCloud Container</strong>: Link to MariaDB and map ports:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker run <span class="nt">-d</span> <span class="nt">--name</span> nextcloud <span class="nt">--link</span> mariadb:mysql <span class="nt">-e</span> <span class="nv">MYSQL_HOST</span><span class="o">=</span>mysql <span class="nt">-e</span> <span class="nv">MYSQL_DATABASE</span><span class="o">=</span>nextcloud <span class="nt">-e</span> <span class="nv">MYSQL_USER</span><span class="o">=</span>nextcloud <span class="nt">-e</span> <span class="nv">MYSQL_PASSWORD</span><span class="o">=</span>nextcloud_password <span class="nt">-v</span> /path/to/nextcloud/data:/var/lib/nextcloud <span class="nt">-v</span> /path/to/nextcloud/config:/etc/nextcloud <span class="nt">-p</span> 80:80 <span class="nt">-p</span> 443:443 <span class="nt">--restart</span> unless-stopped nextcloud/nextcloud
</pre></table></code></div></div><ul><li>Ports 80 and 443 are mapped for HTTP and HTTPS access, respectively, aligning with standard web traffic.</ul><li><strong>Initial Setup</strong>: Access via your DuckDNS domain (e.g., <code class="language-plaintext highlighter-rouge">http://yourname.duckdns.org</code>) to complete the web-based installation, setting up admin credentials and additional configurations.</ul><p>Consult <a href="https://docs.nextcloud.com/server/latest/admin_manual/installation/index.html">NextCloud official documentation</a> for further customization.</p><h5 id="4-firewall-configuration"><span class="mr-2">4. Firewall Configuration</span><a href="#4-firewall-configuration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>To ensure NextCloud is only accessible via the WireGuard VPN, configure the host’s firewall to restrict access to ports 80 and 443 to the WireGuard subnet.</p><ul><li><strong>Example Configuration</strong>: Assuming WireGuard subnet is <code class="language-plaintext highlighter-rouge">10.0.0.0/24</code>, use iptables:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>iptables <span class="nt">-A</span> INPUT <span class="nt">-s</span> 10.0.0.0/24 <span class="nt">-p</span> tcp <span class="nt">--dport</span> 80 <span class="nt">-j</span> ACCEPT
iptables <span class="nt">-A</span> INPUT <span class="nt">-s</span> 10.0.0.0/24 <span class="nt">-p</span> tcp <span class="nt">--dport</span> 443 <span class="nt">-j</span> ACCEPT
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 80 <span class="nt">-j</span> DROP
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 443 <span class="nt">-j</span> DROP
</pre></table></code></div></div><li>This setup blocks external access to NextCloud, allowing only VPN clients with IPs in the specified subnet.</ul><p>Note: Ensure the host machine supports iptables or use a firewall manager like <code class="language-plaintext highlighter-rouge">ufw</code> if preferred, adjusting commands accordingly.</p><h5 id="5-client-configuration-and-access"><span class="mr-2">5. Client Configuration and Access</span><a href="#5-client-configuration-and-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>Clients need WireGuard installed to connect to the VPN, then access NextCloud securely.</p><ul><li><strong>Install WireGuard</strong>: Follow <a href="https://www.wireguard.com/install">WireGuard</a> for client installation on Windows, macOS, Linux, or mobile devices.<li><strong>Configure Client</strong>: Use the client configuration file provided by the server, connecting to the server’s public IP on port 51820.<li><strong>Access NextCloud</strong>: Once connected, access via the DuckDNS domain (e.g., <code class="language-plaintext highlighter-rouge">http://yourname.duckdns.org</code>), with traffic routed through the VPN for security.</ul><h4 id="integration-and-security-considerations"><span class="mr-2">Integration and Security Considerations</span><a href="#integration-and-security-considerations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>The integration ensures that DuckDNS updates the domain to point to the server’s public IP, WireGuard secures the connection by requiring VPN access, and NextCloud serves as the cloud storage endpoint. The firewall configuration is crucial, restricting NextCloud access to VPN clients, enhancing security against unauthorized access.</p><p>A surprising detail is that DuckDNS, often misunderstood as software to install, is a service requiring a client like the Docker image to update IPs dynamically, which is essential for home servers with dynamic IPs.</p><h4 id="tables-for-clarity"><span class="mr-2">Tables for Clarity</span><a href="#tables-for-clarity" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="table-wrapper"><table><thead><tr><th>Service<th>Docker Image<th>Key Configuration Steps<th>Ports Mapped<tbody><tr><td>DuckDNS<td>linuxserver/duckdns<td>Set TOKEN, SUBDOMAINS, mount config volume<td>None (background)<tr><td>WireGuard<td>linuxserver/wireguard<td>Configure wg0.conf, map 51820/UDP<td>51820/UDP<tr><td>NextCloud<td>nextcloud/nextcloud<td>Link to MariaDB, map 80:80, 443:443<td>80, 443</table></div><div class="table-wrapper"><table><thead><tr><th>Firewall Rule Example (iptables)<th>Description<tbody><tr><td>-A INPUT -s 10.0.0.0/24 -p tcp –dport 80 -j ACCEPT<td>Allow HTTP from WireGuard subnet<tr><td>-A INPUT -s 10.0.0.0/24 -p tcp –dport 443 -j ACCEPT<td>Allow HTTPS from WireGuard subnet<tr><td>-A INPUT -p tcp –dport 80 -j DROP<td>Drop HTTP from other sources<tr><td>-A INPUT -p tcp –dport 443 -j DROP<td>Drop HTTPS from other sources</table></div><h4 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>This setup provides a secure, self-hosted cloud solution with dynamic DNS, leveraging Docker for ease of management. Ensure regular updates to Docker images and monitor logs for any issues, particularly with firewall rules and VPN connectivity.</p><h4 id="key-citations"><span class="mr-2">Key Citations</span><a href="#key-citations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li><a href="https://docs.linuxserver.io/images/docker-duckdns/">linuxserver/duckdns documentation</a><li><a href="https://docs.linuxserver.io/images/docker-wireguard/">linuxserver/wireguard documentation</a><li><a href="https://docs.nextcloud.com/server/latest/admin_manual/installation/index.html">NextCloud official documentation</a><li><a href="https://www.wireguard.com/install/">WireGuard installation guide</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/privacy/'>Privacy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a> <a href="/tags/nextcloud/" class="post-tag no-text-decoration" >nextcloud</a> <a href="/tags/duckdns/" class="post-tag no-text-decoration" >duckdns</a> <a href="/tags/wireguard/" class="post-tag no-text-decoration" >wireguard</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Setup For WireGuard, NextCloud, and DuckDNS using Docker (G) - JMC-memo&amp;url=https://gitjmc.github.io/posts/setup-forwireGuard-nextCloud-and-duckDNS-using-docker/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Setup For WireGuard, NextCloud, and DuckDNS using Docker (G) - JMC-memo&amp;u=https://gitjmc.github.io/posts/setup-forwireGuard-nextCloud-and-duckDNS-using-docker/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://gitjmc.github.io/posts/setup-forwireGuard-nextCloud-and-duckDNS-using-docker/&amp;text=Setup For WireGuard, NextCloud, and DuckDNS using Docker (G) - JMC-memo" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://gitjmc.github.io/posts/setup-forwireGuard-nextCloud-and-duckDNS-using-docker/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="http://service.weibo.com/share/share.php?title=Setup For WireGuard, NextCloud, and DuckDNS using Docker (G) - JMC-memo&amp;url=https://gitjmc.github.io/posts/setup-forwireGuard-nextCloud-and-duckDNS-using-docker/" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/secureFormQualtrics/">How to secure Form in Qualtrics</a><li><a href="/posts/mosquitto-tls/">Mosquitto with Docker Compose and Base Authentication & Let's Encrypt (DuckDNS)</a><li><a href="/posts/common-cli/">Common CLI on linux</a><li><a href="/posts/docker-install/">Install Docker on Deepin 20.x</a><li><a href="/posts/docker-install-ubuntu/">Install Docker on ubuntu and Deepin</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/tuto/">tuto</a> <a class="post-tag" href="/tags/angular/">angular</a> <a class="post-tag" href="/tags/dev/">dev</a> <a class="post-tag" href="/tags/access/">access</a> <a class="post-tag" href="/tags/nextcloud/">nextcloud</a> <a class="post-tag" href="/tags/real-time/">real-time</a> <a class="post-tag" href="/tags/wireguard/">wireguard</a> <a class="post-tag" href="/tags/api/">api</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/acess-home-services-docker-wireguard/"><div class="card-body"> <em class="timeago small" data-ts="1738629300" > 2025-02-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Remotely access to home sercices via wireguard</h3><div class="text-muted small"><p> This post will guide and help you how to set up home services accessed remotely via wireguard. Absolutely! Let’s design a secure, privacy-focused setup where you host services (Nextcloud, Gogs, et...</p></div></div></a></div><div class="card"> <a href="/posts/hub-and-spoke/"><div class="card-body"> <em class="timeago small" data-ts="1738656180" > 2025-02-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hub and Spoke or Site to Site VPN</h3><div class="text-muted small"><p> Cet article montre comment mettre en place l’architecture connue comme Hub And Spoke 1. Yes, absolutely! You can set up WireGuard on a cloud provider (like DigitalOcean) and use it to securely con...</p></div></div></a></div><div class="card"> <a href="/posts/hub-and-spoke-with-docker/"><div class="card-body"> <em class="timeago small" data-ts="1738663560" > 2025-02-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hub and Spoke or Site to Site VPN on docker</h3><div class="text-muted small"><p> Absolutely! Below are Docker Compose examples for both the cloud server (DigitalOcean) and the home server (local network). These configurations will help you set up WireGuard on the cloud server a...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/setting-up-contoling-and-minotoring-an-iot-system/" class="btn btn-outline-primary" prompt="Older"><p>Setting up, contoling and minotoring an IoT system (G)</p></a> <a href="/posts/allow-specific-ports-in-the-firewall-rules-in-deepin/" class="btn btn-outline-primary" prompt="Newer"><p>Allow Specific Ports In The Firewall Rules</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/username">Jerbi Mohamed Chamseddine</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/tuto/">tuto</a> <a class="post-tag" href="/tags/angular/">angular</a> <a class="post-tag" href="/tags/dev/">dev</a> <a class="post-tag" href="/tags/access/">access</a> <a class="post-tag" href="/tags/nextcloud/">nextcloud</a> <a class="post-tag" href="/tags/real-time/">real-time</a> <a class="post-tag" href="/tags/wireguard/">wireguard</a> <a class="post-tag" href="/tags/api/">api</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-REJ95ZFTQX"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-REJ95ZFTQX'); }); </script>
