<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="IoT system for monitoring a dam water pumping station (G)" /><meta property="og:locale" content="en" /><meta name="description" content="It seems like you’re asking about an IoT system for monitoring a dam water pumping station, which I’ll interpret as a setup to manage and monitor water pumping operations at a dam—covering aspects like water levels, pump performance, and system health. Given your familiarity with Angular, Spring Boot, and Docker from your previous question, I’ll tailor this response to integrate those technologies with an IoT solution, focusing on the ESP32 microcontroller (as recommended earlier) for its versatility and fit for such a task. Let’s break this down into a practical system design." /><meta property="og:description" content="It seems like you’re asking about an IoT system for monitoring a dam water pumping station, which I’ll interpret as a setup to manage and monitor water pumping operations at a dam—covering aspects like water levels, pump performance, and system health. Given your familiarity with Angular, Spring Boot, and Docker from your previous question, I’ll tailor this response to integrate those technologies with an IoT solution, focusing on the ESP32 microcontroller (as recommended earlier) for its versatility and fit for such a task. Let’s break this down into a practical system design." /><link rel="canonical" href="https://gitjmc.github.io/posts/tempo-1/" /><meta property="og:url" content="https://gitjmc.github.io/posts/tempo-1/" /><meta property="og:site_name" content="JMC-memo" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-02-24T06:35:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="IoT system for monitoring a dam water pumping station (G)" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-02-24T06:35:00-05:00","datePublished":"2025-02-24T06:35:00-05:00","description":"It seems like you’re asking about an IoT system for monitoring a dam water pumping station, which I’ll interpret as a setup to manage and monitor water pumping operations at a dam—covering aspects like water levels, pump performance, and system health. Given your familiarity with Angular, Spring Boot, and Docker from your previous question, I’ll tailor this response to integrate those technologies with an IoT solution, focusing on the ESP32 microcontroller (as recommended earlier) for its versatility and fit for such a task. Let’s break this down into a practical system design.","headline":"IoT system for monitoring a dam water pumping station (G)","mainEntityOfPage":{"@type":"WebPage","@id":"https://gitjmc.github.io/posts/tempo-1/"},"url":"https://gitjmc.github.io/posts/tempo-1/"}</script><title>IoT system for monitoring a dam water pumping station (G) | JMC-memo</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="JMC-memo"><meta name="application-name" content="JMC-memo"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://gitjmc.github.io/assets/img/favicons/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">JMC-memo</a></div><div class="site-subtitle font-italic">À la demande de sisi</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/gitjmc" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>IoT system for monitoring a dam water pumping station (G)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>IoT system for monitoring a dam water pumping station (G)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/username">Jerbi Mohamed Chamseddine</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1740396900" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2025-02-24 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="849 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><p>It seems like you’re asking about an IoT system for monitoring a <strong>dam water pumping station</strong>, which I’ll interpret as a setup to manage and monitor water pumping operations at a dam—covering aspects like water levels, pump performance, and system health. Given your familiarity with Angular, Spring Boot, and Docker from your previous question, I’ll tailor this response to integrate those technologies with an IoT solution, focusing on the ESP32 microcontroller (as recommended earlier) for its versatility and fit for such a task. Let’s break this down into a practical system design.</p><h3 id="system-overview"><span class="mr-2">System Overview</span><a href="#system-overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>An IoT system for a dam water pumping station would monitor water levels, pump status (on/off, runtime, faults), flow rates, and environmental conditions (e.g., pressure or temperature), while allowing remote control and real-time alerts. The ESP32 handles the hardware interfacing, Spring Boot serves as the backend, Angular provides the frontend, and Docker containerizes the setup for scalability and deployment ease.</p><h3 id="recommended-hardware-esp32"><span class="mr-2">Recommended Hardware: ESP32</span><a href="#recommended-hardware-esp32" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The <strong>ESP32</strong> remains ideal here:</p><ul><li><strong>Wi-Fi</strong>: Connects to your network for data transmission.<li><strong>GPIO Pins</strong>: Interfaces with sensors and relays for pumps.<li><strong>ADC Channels</strong>: Reads analog sensor data (e.g., water level, pressure).<li><strong>Low Power</strong>: Suitable for continuous operation at a remote dam site.<li><strong>Cost</strong>: Affordable at $5-$10 per unit.</ul><h4 id="hardware-components"><span class="mr-2">Hardware Components</span><a href="#hardware-components" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li><strong>ESP32 DevKit</strong>: Core microcontroller.<li><strong>Sensors</strong>:<ul><li><strong>Ultrasonic Sensor (HC-SR04)</strong>: Measures water level in the dam or reservoir.<li><strong>Flow Sensor (YF-S201)</strong>: Tracks water flow rate through the pump.<li><strong>Pressure Sensor (MPX5700)</strong>: Monitors pump pressure.<li><strong>Current Sensor (ACS712)</strong>: Detects pump power usage for health monitoring.</ul><li><strong>Relays</strong>: Controls pump on/off (e.g., 5V relay for low-power pumps or SSR for high-power AC pumps).<li><strong>Power Supply</strong>: 5V for ESP32, with appropriate AC-DC converters for pumps (e.g., 24V or 120V/240V based on pump specs).</ul><h3 id="system-architecture"><span class="mr-2">System Architecture</span><a href="#system-architecture" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ol><li><strong>ESP32 Firmware</strong><ul><li><strong>Platform</strong>: Arduino IDE or ESP-IDF.<li><strong>Functionality</strong>:<ul><li>Poll sensors every few seconds (e.g., water level, flow, pressure, current).<li>Control pump via relay based on commands or thresholds (e.g., turn on if level &gt; 50%, off if &lt; 10%).<li>Send data to Spring Boot via REST API or MQTT for real-time updates.</ul><li><strong>Sample Code Snippet</strong> (Arduino):<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;WiFi.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;HTTPClient.h&gt;</span><span class="cp">
</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">ssid</span> <span class="o">=</span> <span class="s">"your-wifi"</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">password</span> <span class="o">=</span> <span class="s">"your-password"</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">server</span> <span class="o">=</span> <span class="s">"http://your-server:8080/api/data"</span><span class="p">;</span>
<span class="cp">#define RELAY_PIN 26
</span><span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
  <span class="n">WiFi</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">ssid</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">RELAY_PIN</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span> <span class="o">==</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">HTTPClient</span> <span class="n">http</span><span class="p">;</span>
    <span class="n">http</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
    <span class="n">http</span><span class="p">.</span><span class="n">POST</span><span class="p">(</span><span class="s">"{</span><span class="se">\"</span><span class="s">level</span><span class="se">\"</span><span class="s">:"</span> <span class="o">+</span> <span class="n">String</span><span class="p">(</span><span class="n">getWaterLevel</span><span class="p">())</span> <span class="o">+</span> <span class="s">",</span><span class="se">\"</span><span class="s">flow</span><span class="se">\"</span><span class="s">:"</span> <span class="o">+</span> <span class="n">String</span><span class="p">(</span><span class="n">getFlowRate</span><span class="p">())</span> <span class="o">+</span> <span class="s">"}"</span><span class="p">);</span>
    <span class="n">http</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="n">delay</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span> <span class="c1">// Poll every 5 seconds</span>
<span class="p">}</span>
<span class="kt">float</span> <span class="nf">getWaterLevel</span><span class="p">()</span> <span class="p">{</span> <span class="cm">/* HC-SR04 logic */</span> <span class="p">}</span>
<span class="kt">float</span> <span class="nf">getFlowRate</span><span class="p">()</span> <span class="p">{</span> <span class="cm">/* YF-S201 logic */</span> <span class="p">}</span>
</pre></table></code></div></div></ul><li><strong>Backend: Spring Boot</strong><ul><li><strong>Purpose</strong>: Processes data, stores it, and serves the Angular frontend.<li><strong>Features</strong>:<ul><li>REST API: <code class="language-plaintext highlighter-rouge">/api/data</code> (POST for ESP32 data, GET for frontend).<li>MQTT Broker (e.g., Mosquitto): For real-time pump status.<li>Database: PostgreSQL for historical data (levels, pump runtime).</ul><li><strong>Dockerfile</strong>:<div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> openjdk:17-jdk-slim</span>
<span class="k">COPY</span><span class="s"> target/dam-monitoring.jar /app.jar</span>
<span class="k">ENTRYPOINT</span><span class="s"> ["java", "-jar", "/app.jar"]</span>
</pre></table></code></div></div></ul><li><strong>Frontend: Angular</strong><ul><li><strong>Purpose</strong>: Displays real-time data and controls pumps.<li><strong>Features</strong>:<ul><li>Dashboard: Water level gauge, pump status (on/off), flow rate graph.<li>Controls: Toggle pump manually or set automated thresholds.<li>Alerts: Notify if water level is critical or pump fails (via WebSocket/MQTT).</ul><li><strong>Dockerfile</strong>:<div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> node:18 AS build</span>
<span class="k">WORKDIR</span><span class="s"> /app</span>
<span class="k">COPY</span><span class="s"> . .</span>
<span class="k">RUN </span>npm <span class="nb">install</span> <span class="o">&amp;&amp;</span> ng build <span class="nt">--prod</span>
<span class="k">FROM</span><span class="s"> nginx:alpine</span>
<span class="k">COPY</span><span class="s"> --from=build /app/dist/dam-app /usr/share/nginx/html</span>
</pre></table></code></div></div></ul><li><strong>Docker Compose</strong><ul><li>Combines all services:<div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">backend</span><span class="pi">:</span>
    <span class="na">build</span><span class="pi">:</span> <span class="s">./spring-boot</span>
    <span class="na">ports</span><span class="pi">:</span> <span class="pi">[</span> <span class="s2">"</span><span class="s">8080:8080"</span> <span class="pi">]</span>
    <span class="na">depends_on</span><span class="pi">:</span> <span class="pi">[</span> <span class="nv">db</span><span class="pi">,</span> <span class="nv">mqtt</span> <span class="pi">]</span>
  <span class="na">frontend</span><span class="pi">:</span>
    <span class="na">build</span><span class="pi">:</span> <span class="s">./angular</span>
    <span class="na">ports</span><span class="pi">:</span> <span class="pi">[</span> <span class="s2">"</span><span class="s">80:80"</span> <span class="pi">]</span>
  <span class="na">db</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">postgres:14</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">POSTGRES_DB=dam_db</span>
      <span class="pi">-</span> <span class="s">POSTGRES_USER=user</span>
      <span class="pi">-</span> <span class="s">POSTGRES_PASSWORD=password</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">pgdata:/var/lib/postgresql/data</span>
  <span class="na">mqtt</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">eclipse-mosquitto:2</span>
    <span class="na">ports</span><span class="pi">:</span> <span class="pi">[</span> <span class="s2">"</span><span class="s">1883:1883"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">9001:9001"</span> <span class="pi">]</span>
<span class="na">volumes</span><span class="pi">:</span>
  <span class="na">pgdata</span><span class="pi">:</span>
</pre></table></code></div></div></ul></ol><h3 id="security"><span class="mr-2">Security</span><a href="#security" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><strong>ESP32</strong>:<ul><li>Use HTTPS for REST calls (Let’s Encrypt via Spring Boot).<li>MQTT with TLS and username/password authentication.</ul><li><strong>Spring Boot</strong>:<ul><li>JWT for API security.<li>Store secrets in environment variables (e.g., <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> with <code class="language-plaintext highlighter-rouge">.env</code>).</ul><li><strong>Network</strong>:<ul><li>Deploy behind a VPN (e.g., WireGuard, as in your prior setup).<li>Firewall: Restrict ports 80, 443, 1883 to VPN subnet:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>iptables <span class="nt">-A</span> INPUT <span class="nt">-s</span> 10.13.13.0/24 <span class="nt">-p</span> tcp <span class="nt">-m</span> multiport <span class="nt">--dports</span> 80,443,1883 <span class="nt">-j</span> ACCEPT
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">-m</span> multiport <span class="nt">--dports</span> 80,443,1883 <span class="nt">-j</span> DROP
</pre></table></code></div></div></ul></ul><h3 id="implementation-steps"><span class="mr-2">Implementation Steps</span><a href="#implementation-steps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ol><li><strong>Hardware</strong>: Connect ESP32 to sensors and relays (e.g., ultrasonic to GPIO 12/13, relay to GPIO 26).<li><strong>Firmware</strong>: Flash ESP32 with code to read sensors and send data.<li><strong>Backend</strong>: Deploy Spring Boot with API and MQTT endpoints.<li><strong>Frontend</strong>: Build Angular app with real-time UI.<li><strong>Docker</strong>: Run <code class="language-plaintext highlighter-rouge">docker-compose up -d</code> in your project directory.<li><strong>Test</strong>: Monitor via <code class="language-plaintext highlighter-rouge">http://your-subdomain.duckdns.org</code> over VPN, ensuring pump control works.</ol><h3 id="why-this-works-for-a-dam-pumping-station"><span class="mr-2">Why This Works for a Dam Pumping Station?</span><a href="#why-this-works-for-a-dam-pumping-station" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><strong>Scalability</strong>: Add more ESP32s for additional pumps or sensors.<li><strong>Real-Time</strong>: MQTT ensures instant updates for critical events (e.g., pump failure).<li><strong>Security</strong>: VPN and HTTPS protect against unauthorized access.<li><strong>Integration</strong>: Leverages your Angular/Spring Boot/Docker skills.</ul><p>If you need specific code, hardware wiring diagrams, or help with deployment, let me know! This setup balances cost, functionality, and security for a dam water pumping station.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/architecture/'>Architecture</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/monitoring/" class="post-tag no-text-decoration" >monitoring</a> <a href="/tags/esp32/" class="post-tag no-text-decoration" >esp32</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=IoT system for monitoring a dam water pumping station (G) - JMC-memo&amp;url=https://gitjmc.github.io/posts/tempo-1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=IoT system for monitoring a dam water pumping station (G) - JMC-memo&amp;u=https://gitjmc.github.io/posts/tempo-1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://gitjmc.github.io/posts/tempo-1/&amp;text=IoT system for monitoring a dam water pumping station (G) - JMC-memo" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://gitjmc.github.io/posts/tempo-1/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="http://service.weibo.com/share/share.php?title=IoT system for monitoring a dam water pumping station (G) - JMC-memo&amp;url=https://gitjmc.github.io/posts/tempo-1/" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/secureFormQualtrics/">How to secure Form in Qualtrics</a><li><a href="/posts/mosquitto-tls/">Mosquitto with Docker Compose and Base Authentication & Let's Encrypt (DuckDNS)</a><li><a href="/posts/common-cli/">Common CLI on linux</a><li><a href="/posts/docker-install/">Install Docker on Deepin 20.x</a><li><a href="/posts/docker-install-ubuntu/">Install Docker on ubuntu and Deepin</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/tuto/">tuto</a> <a class="post-tag" href="/tags/angular/">angular</a> <a class="post-tag" href="/tags/dev/">dev</a> <a class="post-tag" href="/tags/access/">access</a> <a class="post-tag" href="/tags/nextcloud/">nextcloud</a> <a class="post-tag" href="/tags/real-time/">real-time</a> <a class="post-tag" href="/tags/wireguard/">wireguard</a> <a class="post-tag" href="/tags/api/">api</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/iot-system-for-monitoring-a-dam-water-pumping-station/"><div class="card-body"> <em class="timeago small" data-ts="1739540100" > 2025-02-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>IoT system for monitoring a dam water pumping station (G)</h3><div class="text-muted small"><p> It seems like you’re asking about an IoT system for monitoring a dam water pumping station, which I’ll interpret as a setup to manage and monitor water pumping operations at a dam—covering aspects ...</p></div></div></a></div><div class="card"> <a href="/posts/setting-up-contoling-and-minotoring-an-iot-system/"><div class="card-body"> <em class="timeago small" data-ts="1739574720" > 2025-02-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Setting up, contoling and minotoring an IoT system (G)</h3><div class="text-muted small"><p> Setting up an IoT system to control and monitor your garden irrigation, pool pump, indoor/outdoor lights, heater, and other devices with Angular, Spring Boot, and Docker is a great choice, as these...</p></div></div></a></div><div class="card"> <a href="/posts/esp32/"><div class="card-body"> <em class="timeago small" data-ts="1740838740" > 2025-03-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ESP 32</h3><div class="text-muted small"><p> The ESP32 microcontroller has a versatile set of peripherals and GPIO pins, allowing you to connect multiple sensors. However, the exact number of sensors you can connect depends on several factors...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/how-to-remain-ubuntu-server-active-and-not-enter-sleep-or-suspend-mode/" class="btn btn-outline-primary" prompt="Older"><p>How to remain Ubuntu Server active and not enter sleep or suspend mode (DS)</p></a> <a href="/posts/iot-tools/" class="btn btn-outline-primary" prompt="Newer"><p>IoT Stuck</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/username">Jerbi Mohamed Chamseddine</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/tuto/">tuto</a> <a class="post-tag" href="/tags/angular/">angular</a> <a class="post-tag" href="/tags/dev/">dev</a> <a class="post-tag" href="/tags/access/">access</a> <a class="post-tag" href="/tags/nextcloud/">nextcloud</a> <a class="post-tag" href="/tags/real-time/">real-time</a> <a class="post-tag" href="/tags/wireguard/">wireguard</a> <a class="post-tag" href="/tags/api/">api</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-REJ95ZFTQX"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-REJ95ZFTQX'); }); </script>
